# Simple ASCII Video Format (SAVF)

## Introduction

SAVF is designed to store ASCII video stream in this project.

## Requirements

The stream can be generated by any ASCII character utility.

Character set: (the last one is a *space character*, a total of 16 characters.)

```
M@W08Za2S7ri:;. 
```



## Specification

**Resolution**: Fixed **40*16**, at any frame rate.

**Header**: SAVF has no video header but a terminating frame, indicated by an invalid frame header.



| Hex Code | 0       | 1    | 2    | 3    | 4    | 5    | 6    | 7    | 8    | 9    | A    | B    | C    | D    | E    | F    |
| -------- | ------- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- |
| Original | *Space* | M    | @    | W    | 0    | 8    | Z    | a    | 2    | S    | 7    | r    | i    | :    | ;    | .    |





### Frames

Frames are of two categories:

| Name        | Code    | Code | Description                                                  |
| ----------- | ------- | ---- | ------------------------------------------------------------ |
| Key Frame   | [**K**] | 0    | Key frame that is followed by a list of mapping entries and captures the entire frame in compressed format |
| Delta Frame | [**D**] | 1    | Delta frame that modifies the previous frame to generate a new frame |

**Each frame must be aligned on a 32-bit boundary.**

The byte order is *little-endian*, following the convention of MARS and the toolsets included in this repository.

```
31 (MSB)                     (LSB) 0
|----------------------------------|
| entry n | .... | entry2 | entry1 |
|----------------------------------|
```



#### 1. Key Frame

##### Key Frame Header:  (32 bit)

| Bit Offset (LSB) | Boundary | Type              | Description                                           |
| ---------------- | -------- | ----------------- | ----------------------------------------------------- |
| 31               | 31       | 32-bit Identifier | `0` for **D** and `1` for **K**                       |
| 0                | 30       | Reserved          | Must be `0`. If full `1`, then this is the last frame |



#### 2. Delta Frame

##### Delta Frame Header: (16 bit)

| Bit Offset (LSB) | Boundary | Type               | Description                                                  |
| ---------------- | -------- | ------------------ | ------------------------------------------------------------ |
| 15               | 15       | 32-bit Identifier  | `0` for **D** and `1` for **K**                              |
| 0                | 14       | #Delta Entry Count | Number of entries that records a modification to the previous frame. If `0` then this frame completely the same as the previous one. |

*The identifier is chosen to be 0 here for quick processing.*



##### Delta Frame Entry  (16 bit)

| Bit Offset (LSB) | Boundary | Name     | Description                      |
| ---------------- | -------- | -------- | -------------------------------- |
| 10               | 15       | Y-offset | Y-axis offset, from `0` to `64`. |
| 4                | 9        | X-offset | X-axis offset, from `0` to `64`. |
| 0                | 3        | Char     | Character in 4 bits              |

